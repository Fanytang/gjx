webpackJsonp([22],{"04MH":function(n,t,a){"use strict";function e(n){a("kNVv")}Object.defineProperty(t,"__esModule",{value:!0});var i=(a("7u7+"),a("U7mS"),{data:function(){return{isPhoto:!0,imgUrls:[],filesItem:[],alarmDisposeExplain:"",alarmsingledata:[],alarmonuname:"",projectid:"",phoneNum:""}},watch:{imgUrls:"toggleAddPic"},created:function(){this.phoneNum=sessionStorage.getItem("phone"),this.alarmsingledata=JSON.parse(this.$route.query.itemdata),console.log(this.alarmsingledata)},methods:{upLoadImg:function(){if(0==this.imgUrls.length)this.postalarm();else{for(var n=this,t=0;t<n.imgUrls.length;t++){n.$vux.loading.show({text:"上传图片中"});var a=new FileUploadOptions;a.chunkedMode=!1,a.fileKey="file",a.fileName=n.alarmsingledata.alarmInfoId+","+n.imgUrls[t].substring(n.imgUrls[t].lastIndexOf("/")+1),a.mimeType="image/jpeg",a.httpMethod="POST";var e=new FileTransfer,i=function(t){n.$vux.loading.hide(),n.$vux.toast.show({text:"图片上传成功",type:"text"})},s=function(t){n.$vux.loading.hide(),n.$vux.toast.show({text:"图片上传失败",type:"text"})};e.upload(n.imgUrls[t],encodeURI("http://www.foome.com.cn:8080/OnuMonitorNew/AlarmUploadServlet"),i,s,a)}n.postalarm()}},open:function(){function n(n){a.imgUrls.push(n)}function t(n){navigator.notification.alert("拍照失败，原因："+n)}var a=this;navigator.camera.getPicture(n,t,{destinationType:Camera.DestinationType.FILE_URI,quality:30})},toggleAddPic:function(){var n=this;n.imgUrls.length>=1?n.isPhoto=!1:n.isPhoto=!0},addPic:function(n){return this.$refs.divGenres.querySelectorAll("input[type=file]")[0].click(),!1},delImage:function(n){this.imgUrls.splice(n,1)},goHome:function(){this.$router.push({name:"home"})},gomap:function(){console.log(this.alarmsingledata.onuId),this.$router.push({name:"map",params:{onuId:this.alarmsingledata.onuId}})},unlock:function(n){var t=this;this.$vux.loading.show({text:"正在解锁中"}),this.$jsonp("http://www.foome.com.cn:8080/ONUDataGather/lockController/openLock?phoneNum="+this.phoneNum+"&deviceNum="+this.alarmsingledata.deviceNum+"&lockflag="+n,{callbackName:"openLock_callback"}).then(function(n){t.$vux.loading.hide(),console.log(n),"success"==n.name?t.$vux.toast.show({text:"开锁指令下发成功",type:"success",isShowMask:!0}):"wait"==n.name?t.$vux.toast.show({text:"现场设备未准备好,请先激活",type:"warn",isShowMask:!0}):"opened"==n.name?t.$vux.toast.show({text:"门已被打开",type:"success",isShowMask:!0}):"noConfig"==n.name&&t.$vux.toast.show({text:"参数未配置",type:"cancel",isShowMask:!0})})},postalarm:function(){var n=this;this.$vux.loading.show({text:"加载中"}),this.$http.get("/OnuMonitorNew/DataCommunicate",{params:{requestType:110,alarmDisposeExplain:this.alarmDisposeExplain,alarmInfoId:this.alarmsingledata.alarmInfoId,phoneNum:this.phoneNum}}).then(function(t){console.log(t),n.$vux.loading.hide(),"success"==t.data?(n.$vux.toast.show({text:"数据提交成功",type:"text"}),n.$router.back(-1)):n.$vux.toast.show({text:"数据提交失败",type:"text"})})}}}),s=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"alarmsingleconf"},[e("x-header",{staticClass:"myHeader"},[n._v("告警确认"),e("img",{attrs:{slot:"right",width:"22",height:"22",src:a("77/w"),alt:""},on:{click:function(t){n.goHome()}},slot:"right"})]),n._v(" "),e("group",{attrs:{"label-width":"5em",title:"告警详情"}},[e("cell",{staticClass:"searchtxt",attrs:{primary:"content",title:"光交名称",value:n.alarmsingledata.onuName}}),n._v(" "),e("cell",{staticClass:"searchtxt",attrs:{primary:"content",title:"归属区域",value:n.alarmsingledata.area}}),n._v(" "),e("cell",{staticClass:"searchtxt",attrs:{primary:"content",title:"告警信息",value:n.alarmsingledata.alarmMessage}}),n._v(" "),e("cell",{staticClass:"searchtxt",attrs:{primary:"content",title:"告警时间",value:n.alarmsingledata.alarmTime}}),n._v(" "),e("cell",{staticClass:"searchtxt",attrs:{primary:"content",title:"详细地址",value:n.alarmsingledata.addr}})],1),n._v(" "),e("group",{attrs:{"label-width":"5em",title:"图片拍摄"}},[e("div",{ref:"divGenres",staticClass:"img-div"},[e("img",{directives:[{name:"show",rawName:"v-show",value:n.isPhoto,expression:"isPhoto"}],staticClass:"addpic",attrs:{src:a("dRIw")},on:{click:function(t){n.open()}}}),n._v(" "),e("ul",{directives:[{name:"show",rawName:"v-show",value:!n.isPhoto,expression:"!isPhoto"}]},n._l(n.imgUrls,function(t,i){return e("li",{staticClass:"list-link"},[e("img",{staticClass:"pickimg",attrs:{src:t}}),n._v(" "),e("img",{staticClass:"delimg",attrs:{src:a("j9iW")},on:{click:function(t){n.delImage(i)}}})])}))]),n._v(" "),e("flexbox",{staticClass:"myflexbox"},[e("flexbox-item",[e("x-button",{staticClass:"collbtn",attrs:{type:"primary"},nativeOn:{click:function(t){n.open()}}},[n._v("拍照")])],1),n._v(" "),e("flexbox-item",[e("x-button",{staticClass:"collbtn",attrs:{type:"primary"},nativeOn:{click:function(t){n.unlock(0)}}},[n._v("开锁")])],1),n._v(" "),e("flexbox-item",[e("x-button",{staticClass:"collbtn",attrs:{type:"primary"},nativeOn:{click:function(t){n.gomap()}}},[n._v("地图")])],1)],1)],1),n._v(" "),e("group",{attrs:{"label-width":"5em",title:"告警情况说明"}},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:n.alarmDisposeExplain,expression:"alarmDisposeExplain"}],staticClass:"textareabox",attrs:{name:"",id:"",rows:"5"},domProps:{value:n.alarmDisposeExplain},on:{input:function(t){t.target.composing||(n.alarmDisposeExplain=t.target.value)}}}),n._v(" "),e("flexbox",{staticClass:"myflexbox"},[e("flexbox-item",[e("x-button",{staticClass:"collbtn",attrs:{type:"primary"},nativeOn:{click:function(t){n.upLoadImg()}}},[n._v("告警确认提交")])],1)],1)],1)],1)},o=[],l={render:s,staticRenderFns:o},r=l,c=a("VU/8"),m=e,u=c(i,r,!1,m,"data-v-4cd082ea",null);t.default=u.exports},"7u7+":function(n,t,a){var e=a("JUj1");"string"==typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);a("rjj0")("71143492",e,!0,{})},JUj1:function(n,t,a){t=n.exports=a("FZ+f")(!1),t.push([n.i,".alarmsingleconf {\n  height: 100vh;\n  padding-top: 46px; }\n  .alarmsingleconf .myHeader {\n    position: fixed;\n    width: 100%;\n    z-index: 1;\n    top: 0; }\n  .alarmsingleconf .searchtxt {\n    font-size: 12px; }\n  .alarmsingleconf .doitornot {\n    margin-left: 15px; }\n  .alarmsingleconf .searchtit {\n    font-size: 12px; }\n  .alarmsingleconf .myflexbox {\n    padding: 0.9375rem 0.625rem; }\n  .alarmsingleconf .collbtn {\n    font-size: 14px; }\n  .alarmsingleconf .logbox {\n    height: 100%;\n    overflow: auto;\n    -webkit-overflow-scrolling: touch;\n    position: relative; }\n  .alarmsingleconf .textareabox {\n    padding: 15px;\n    width: 100%; }\n  .alarmsingleconf .img-div .addpic {\n    width: 30%;\n    margin-left: 0.59375rem;\n    margin-top: 0.59375rem; }\n  .alarmsingleconf .img-div ul {\n    overflow: hidden; }\n  .alarmsingleconf .img-div ul li .pickimg {\n      width: 30%;\n      float: left;\n      margin-left: 0.59375rem;\n      margin-top: 0.59375rem; }\n  .alarmsingleconf .img-div ul li .delimg {\n      background: #ffffff;\n      width: 1.25rem;\n      border-color: #ff4a00;\n      z-index: 1;\n      float: left;\n      margin-left: -1.5rem;\n      border-radius: 0.3125rem;\n      margin-top: 0.8125rem; }\n",""])},kNVv:function(n,t,a){var e=a("vuK5");"string"==typeof e&&(e=[[n.i,e,""]]),e.locals&&(n.exports=e.locals);a("rjj0")("5ca5bc31",e,!0,{})},vuK5:function(n,t,a){t=n.exports=a("FZ+f")(!1),t.push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});